15734 L15734A
15734 L15734B
15734 15734U
15744 L15744C
15744 L15744D
15744 15744W"
read.table(f)
read.table(text=f)
f="15582 F15582A	Ts21	F
15582 F15582C	Ts21	F
15593 F15593A	Ts21	F
15593 F15593P	Ts21	F
15619 15619D	Ts21	M
15619 15619E	Ts21	M
15619 F15619F	Ts21	M
15636 F15636R	Ts21	M
15636 F15636B	Ts21	M
15646 F15646J	Ts21	F
15656 F15656E	Ts21	M
15667 F15667C	Ts21	F
15667 F15667D	Ts21	F
15667 15667M	Ts21	F
15669 F15669F	Ts21	F
15669 F15669P	Ts21	F
15712 15712D	Ts21	M
15724 F15724H	Ts21	M
15734 F15734L	Ts21	F
15734 F15734M	Ts21	F
15734 15734V	Ts21	F
15744 F15744P	Ts21	F
15744 F15744N	Ts21	F
15744 15744Z	Ts21	F
15532 T21 15532 A	Ts21	F
15532 T21 15532 B	Ts21	F
15532 T21 15532 C	Ts21	F
15532 T21 15532 D	Ts21	F
15532 T21 15532 E	Ts21	F
15532 L15532M	Ts21	F
15559 T21 15559 A	Ts21	M
15559 T21 15559 B	Ts21	M
15559 T21 15559 C	Ts21	M
15562 T21 15562 A	Ts21	M
15562 T21 15562 B	Ts21	M
15582 T21 15582 A	Ts21	F
15582 T21 15582 B	Ts21	F
15582 15582E	Ts21	F
15582 15582F	Ts21	F
15582 15582G	Ts21	F
15593 L15593E	Ts21	F
15593 L15593F	Ts21	F
15593 L15593N	Ts21	F
15619 15619A	Ts21	M
15619 15619B	Ts21	M
15619 15619C	Ts21	M
15636 L15636B	Ts21	M
15636 L15636C	Ts21	M
15636 L15636D	Ts21	M
15636 L15636Q	Ts21	M
15646 15646A	Ts21	F
15646 15646B	Ts21	F
15646 L15646H	Ts21	F
15656 15656C	Ts21	M
15656 15656D	Ts21	M
15656 L15656I	Ts21	M
15667 15667E	Ts21	F
15667 15667F	Ts21	F
15667 L15667L	Ts21	F
15669 15669G	Ts21	F
15669 15669H	Ts21	F
15669 L15669N	Ts21	F
15712 15712A	Ts21	M
15712 15712B	Ts21	M
15712 L15712Q	Ts21	M
15724 15724C	Ts21	M
15724 15724D	Ts21	M
15724 L15724T	Ts21	M
15734 L15734A	Ts21	F
15734 L15734B	Ts21	F
15734 15734U	Ts21	F
15744 L15744C	Ts21	F
15744 L15744D	Ts21	F
15744 15744W	Ts21	F"
read.table(text=f)
f="15582 F15582A
15582 F15582C
15593 F15593A
15593 F15593P
15619 15619D
15619 15619E
15619 F15619F
15636 F15636R
15636 F15636B
15646 F15646J
15656 F15656E
15667 F15667C
15667 F15667D
15667 15667M
15669 F15669F
15669 F15669P
15712 15712D
15724 F15724H
15734 F15734L
15734 F15734M
15734 15734V
15744 F15744P
15744 F15744N
15744 15744Z
15532 T21 15532 A
15532 T21 15532 B
15532 T21 15532 C
15532 T21 15532 D
15532 T21 15532 E
15532 L15532M
15559 T21 15559 A
15559 T21 15559 B
15559 T21 15559 C
15562 T21 15562 A
15562 T21 15562 B
15582 T21 15582 A
15582 T21 15582 B
15582 15582E
15582 15582F
15582 15582G
15593 L15593E
15593 L15593F
15593 L15593N
15619 15619A
15619 15619B
15619 15619C
15636 L15636B
15636 L15636C
15636 L15636D
15636 L15636Q
15646 15646A
15646 15646B
15646 L15646H
15656 15656C
15656 15656D
15656 L15656I
15667 15667E
15667 15667F
15667 L15667L
15669 15669G
15669 15669H
15669 L15669N
15712 15712A
15712 15712B
15712 L15712Q
15724 15724C
15724 15724D
15724 L15724T
15734 L15734A
15734 L15734B
15734 15734U
15744 L15744C
15744 L15744D
15744 15744W"
read.table(text=f)
read.table(text=f)[,1]
unique(read.table(text=f)[,1])
length(unique(read.table(text=f)[,1]))
f="~/Downloads/tmp.csv"
read.table(f)
f="~/Downloads/tmp.csv"
read.table(f)
read.csv(f)
df=read.csv(f)
head(df)
strsplit(df[,1]," ")
lapply(strsplit(df[,1]," "),function(x)x[[1]])
unlist(lapply(strsplit(df[,1]," "),function(x)x[[1]]))
df$id = unlist(lapply(strsplit(df[,1]," "),function(x)x[[1]]))
head(df)
table(df$id,df$Sex)
f="~/Downloads/tmp.csv"
df=read.csv(f)
head(df)
df$id = unlist(lapply(strsplit(df[,1]," "),function(x)x[[1]]))
df = df[!(duplicated(df$id)),]
head(Df)
head(df)
table(df$Sex)
library(Seurat)
library(stringr)
source("~/Documents/Research/Useful_scripts/rntransform.R")
cell_type_filename="HSCs_MPPs"
f.out=paste0("~/Documents/Research/t21-proj/out/full/data/cell_subset/",cell_type_filename,".all_sig_genes.rds")
res <- fread("~/Documents/Research/t21-proj/out/full/DEG_list/liver_v_femur.txt",data.table = F,stringsAsFactors = F)
dfcombined=readRDS(f.out)
# res <- fread("~/Documents/Research/t21-proj/out/full/DEG_list/t21_v_healthy.txt",data.table = F,stringsAsFactors = F)
# f.out=paste0("~/Documents/Research/t21-proj/out/full/data/cell_subset/",cell_type_filename,".all_sig_genes.t21.rds")
# dfcombined=readRDS(f.out)
upreg_t21_induced <- apply(apply(dfcombined[["RNA"]][subset(res,class=="t21-induced" & logFC.t21 > 0)$names,],1,scale),1,mean)
aggregate(upreg_t21_induced,by=list(dfcombined$environment,dfcombined$organ),mean)
aggregate(upreg_t21_induced,by=list(dfcombined$environment,dfcombined$organ),median)
env <- factor(dfcombined$environment,levels = c("Healthy","Down Syndrome"))
summary(lm(upreg_t21_induced~env*dfcombined$organ))
library(Seurat)
library(stringr)
source("~/Documents/Research/Useful_scripts/rntransform.R")
cell_type_filename="HSCs_MPPs"
f.out=paste0("~/Documents/Research/t21-proj/out/full/data/cell_subset/",cell_type_filename,".all_sig_genes.rds")
f.out
cell_type_filename="HSCs_MPPs"
f.out=paste0("~/Documents/Research/t21-proj/out/full/data/cell_subset/",cell_type_filename,".all_sig_genes.rds")
res <- fread("~/Documents/Research/t21-proj/out/full/DEG_list/liver_v_femur.txt",data.table = F,stringsAsFactors = F)
library(data.table)
source("~/Documents/Research/Useful_scripts/rntransform.R")
cell_type_filename="HSCs_MPPs"
f.out=paste0("~/Documents/Research/t21-proj/out/full/data/cell_subset/",cell_type_filename,".all_sig_genes.rds")
res <- fread("~/Documents/Research/t21-proj/out/full/DEG_list/liver_v_femur.txt",data.table = F,stringsAsFactors = F)
dfcombined=readRDS(f.out)
upreg_t21_induced <- apply(apply(dfcombined[["RNA"]][subset(res,class=="t21-induced" & logFC.t21 > 0)$names,],1,scale),1,mean)
aggregate(upreg_t21_induced,by=list(dfcombined$environment,dfcombined$organ),mean)
aggregate(upreg_t21_induced,by=list(dfcombined$environment,dfcombined$organ),median)
env <- factor(dfcombined$environment,levels = c("Healthy","Down Syndrome"))
summary(lm(upreg_t21_induced~env*dfcombined$organ))
glst = list()
df.mg = list()
env <- factor(dfcombined$environment,levels = c("Healthy","Down Syndrome"))
# for (class_to_use in c("environment-independent","liver-induced")) {
for (class_to_use in c("environment-driven","t21-induced")) {
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
# input=subset(res,class==class_to_use & logFC.liv > 0)$names
input=subset(res,class==class_to_use & logFC.t21 > 0)$names
# input=subset(res,class=="environment-driven" & logFC.t21 > 0)$names
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
y <- apply(apply(dfcombined[["RNA"]][input,],1,scale),1,mean)
# y <- apply(apply(dfcombined[["RNA"]]["GATA1",],1,scale),1,mean)
# y <- apply(apply(dfcombined[["RNA"]][subset(res,class=="environment-driven" & logFC.t21 < 0)$names,],1,scale),1,mean)
# aggregate(y,by=list(dfcombined$environment,dfcombined$organ),mean)
# aggregate(y,by=list(dfcombined$environment,dfcombined$organ),median)
y <- rntransform(y)
summary(lm(y~env*organ,dftmp <- data.frame(y=y,env=env,organ=dfcombined$organ)))
# ggplot(dftmp,aes(x=env,y=rntransform(y),col=organ)) + geom_boxplot()
#
df.mg[[class_to_use]] = merge(aggregate(y,by=list(dfcombined$environment,dfcombined$organ),function(x) sd(x)/sqrt(length(input))),
aggregate(y,by=list(dfcombined$environment,dfcombined$organ),mean),
by=c("Group.1","Group.2"))
glst[[class_to_use]] <- ggplot(df.mg[[class_to_use]],aes(x=as.numeric(as.factor(Group.2)),
y=x.y,
col=Group.1,
ymin=x.y-2*x.x,
ymax=x.y+2*x.x)) +
geom_line() +
# geom_pointrange(position=position_dodge(0.05)) +
# geom_linerange(position=position_dodge(0.05)) +
# geom_pointrange(stat="summary",fun.ymin=df.mg[[class_to_use]]$x.y-2*df.mg[[class_to_use]]$x.x,fun.ymax=df.mg[[class_to_use]]$x.y+2*df.mg[[class_to_use]]$x.x,fun.y=median) +
geom_point(size=rel(2)) +
geom_errorbar(aes(ymin=x.y-2*x.x,ymax=x.y+2*x.x),width=.2) + #,position=position_dodge(0.05)) +
theme_bw() + theme(panel.grid = element_blank(),plot.title = element_text(hjust=0.5)) +
labs(x="Environment",y="Average normalized expression (+/- 2 SE)",col="Disease status",title=str_to_title(class_to_use)) +
scale_x_continuous(labels=c("Femur","Liver"),breaks=c(1,2)) +
scale_color_brewer(palette = "Set1")
# glst[[class_to_use]] <- ggplot(dftmp,aes(x=organ,y=rntransform(y),col=env)) + geom_boxplot() +
#   theme_bw() + theme(panel.grid = element_blank()) +
#   labs(x="Environment",y="Normalized expression",col="Disease status",title=str_to_title(class_to_use))
}
library(ggplot2)
# for (class_to_use in c("environment-independent","liver-induced")) {
for (class_to_use in c("environment-driven","t21-induced")) {
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
# input=subset(res,class==class_to_use & logFC.liv > 0)$names
input=subset(res,class==class_to_use & logFC.t21 > 0)$names
# input=subset(res,class=="environment-driven" & logFC.t21 > 0)$names
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
# input=subset(res,class==class_to_use & logFC.t21 < 0)$names
y <- apply(apply(dfcombined[["RNA"]][input,],1,scale),1,mean)
# y <- apply(apply(dfcombined[["RNA"]]["GATA1",],1,scale),1,mean)
# y <- apply(apply(dfcombined[["RNA"]][subset(res,class=="environment-driven" & logFC.t21 < 0)$names,],1,scale),1,mean)
# aggregate(y,by=list(dfcombined$environment,dfcombined$organ),mean)
# aggregate(y,by=list(dfcombined$environment,dfcombined$organ),median)
y <- rntransform(y)
summary(lm(y~env*organ,dftmp <- data.frame(y=y,env=env,organ=dfcombined$organ)))
# ggplot(dftmp,aes(x=env,y=rntransform(y),col=organ)) + geom_boxplot()
#
df.mg[[class_to_use]] = merge(aggregate(y,by=list(dfcombined$environment,dfcombined$organ),function(x) sd(x)/sqrt(length(input))),
aggregate(y,by=list(dfcombined$environment,dfcombined$organ),mean),
by=c("Group.1","Group.2"))
glst[[class_to_use]] <- ggplot(df.mg[[class_to_use]],aes(x=as.numeric(as.factor(Group.2)),
y=x.y,
col=Group.1,
ymin=x.y-2*x.x,
ymax=x.y+2*x.x)) +
geom_line() +
# geom_pointrange(position=position_dodge(0.05)) +
# geom_linerange(position=position_dodge(0.05)) +
# geom_pointrange(stat="summary",fun.ymin=df.mg[[class_to_use]]$x.y-2*df.mg[[class_to_use]]$x.x,fun.ymax=df.mg[[class_to_use]]$x.y+2*df.mg[[class_to_use]]$x.x,fun.y=median) +
geom_point(size=rel(2)) +
geom_errorbar(aes(ymin=x.y-2*x.x,ymax=x.y+2*x.x),width=.2) + #,position=position_dodge(0.05)) +
theme_bw() + theme(panel.grid = element_blank(),plot.title = element_text(hjust=0.5)) +
labs(x="Environment",y="Average normalized expression (+/- 2 SE)",col="Disease status",title=str_to_title(class_to_use)) +
scale_x_continuous(labels=c("Femur","Liver"),breaks=c(1,2)) +
scale_color_brewer(palette = "Set1")
# glst[[class_to_use]] <- ggplot(dftmp,aes(x=organ,y=rntransform(y),col=env)) + geom_boxplot() +
#   theme_bw() + theme(panel.grid = element_blank()) +
#   labs(x="Environment",y="Normalized expression",col="Disease status",title=str_to_title(class_to_use))
}
plot_grid(plotlist = glst)
library(cowplot)
plot_grid(plotlist = glst)
library(ggplot2)
library(data.table)
library(scales)
df1.full.mg = fread("~/Documents/Research/t21-proj/out/full/DEG_list/liver_v_femur.txt",data.table = F,stringsAsFactors = F)
g <- ggplot(df1.full.mg,aes(x=-log10(P.Value.h),y=-log10(P.Value.t21),col=class)) +
geom_point(aes(alpha=ifelse(class=="none",0.5,1))) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid = element_blank()) +
geom_vline(xintercept = 0) +
geom_hline(yintercept = 0) +
labs(x="LFC (Healthy)",y="LFC (T21)") +
# scale_color_brewer(palette="Set3",
scale_color_manual(
labels=c("Environment-driven","Not significant","T21-induced","T21-reverted","T21-induced/\nEnvironmental-driven"),
values=c("#8DD3C7" ,"#FFFFB3", "#FB8072" ,"#BEBADA","#80B1D3")) +
guides(alpha="none") +
labs(col="") +
scale_x_continuous(breaks=pretty_breaks()) +
scale_y_continuous(breaks=pretty_breaks())
g
library(data.table)
library(scales)
library(ggplot2)
df1.full.mg = fread("~/Documents/Research/t21-proj/out/full/DEG_list/liver_v_femur.txt",data.table = F,stringsAsFactors = F)
genes_of_interest <- c("TOP2A", "CDC20",  "BIRC5", "CXCR4" , "IL6R",
"GATA1","TAL1","FOXO3","KLF1","AHSP",
"ITGA2B","SERPINE2","FOXO3","APOE","DUSP1")
df1.full.mg$geneLabel <- NA
df1.full.mg$geneLabel[df1.full.mg$names %in% genes_of_interest] <- df1.full.mg$names[df1.full.mg$names %in% genes_of_interest]
tmp1 <- df1.full.mg[,c("logFC.h","P.Value.h","class",'names')]
tmp2 <- df1.full.mg[,c("logFC.t21","P.Value.t21","class",'names')]
colnames(tmp1) <- c("LFC","P","class",'names')
colnames(tmp2) <- c("LFC","P","class",'names')
tmp1$P <- -log10(tmp1$P)
tmp2$P <- log10(tmp2$P)
tmp <- rbind(tmp1,tmp2)
rng <- seq(floor(min(tmp$P)),ceiling(max(tmp$P)),1)
rng <- rng[rng%%2 == 0]
tmp$geneLabel <- NA
tmp$geneLabel[tmp$names %in% genes_of_interest] <- tmp$names[tmp$names %in% genes_of_interest]
g <- ggplot(tmp,aes(x=LFC,y=P,col=class)) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid = element_blank()) +
geom_vline(xintercept = 0) +
geom_hline(yintercept = 0) +
labs(x="LFC (Healthy)",y="LFC (T21)") +
# scale_color_brewer(palette="Set3",
labs(col="",x="LFC",y=expression(-log[10](italic(P)))) +
scale_y_continuous(breaks=rng,labels=abs(rng)) +
scale_x_continuous(breaks=pretty_breaks())
g
gout <- g +
geom_point(aes(alpha=ifelse(class=="none",0.5,1))) +
scale_color_manual(
labels=c("Environment-driven","Not significant","T21-induced","T21-reverted","T21-induced or\nenvironment-driven"),
values=c("#8DD3C7" ,"#FFFFB3", "#FB8072" ,"#BEBADA","#80B1D3")) +
guides(alpha="none")
print(gout)
pdf(paste0("~/Documents/Research/t21-proj/out/full/figures/volcano.liver_v_femur.pdf"),width=8,height=5)
gout <- g +
geom_point(aes(alpha=ifelse(class=="none",0.5,1))) +
scale_color_manual(
labels=c("Environment-driven","Not significant","T21-induced","T21-reverted","T21-induced or\nenvironment-driven"),
values=c("#8DD3C7" ,"#FFFFB3", "#FB8072" ,"#BEBADA","#80B1D3")) +
guides(alpha="none")
print(gout)
dev.off()
library(data.table)
# 0. SCENT!
celltype_to_use="HSCs_H"
# output_file = paste0("/Users/andrewmarderstein/Documents/Research/t21_multiome/output/scent/out1/",celltype_to_use,".txt")
output_file = paste0("/Users/andrewmarderstein/Documents/Research/t21_multiome/output/scent/out_split/all/",celltype_to_use,".all.txt")
res.df.h = fread(output_file,data.table = F,stringsAsFactors = F)
f.plot = paste0("/Users/andrewmarderstein/Documents/Research/t21_multiome/output/scavenge_plots/HSCs.",traitName,".SCENT_enrich.boot.pdf")
library(data.table)
f = "~/Documents/Research/Trisomy/output/data/Trisomy18_Trisomy21_Ctrl/annotations.meta_data.v4.txt"
df = fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
f = "~/Documents/Research/Trisomy/output/data/Trisomy18_Trisomy21_Ctrl/annotations.meta_data.v4.txt"
df = fread(f,data.table = F,stringsAsFactors = F)
preprocess = function(df,label) {
df[,paste0(label,"_broad_2")] = df[,paste0(label,"_broad")]
df[,paste0(label,"_broad_2")][grep("Monocytic|Granulocytic|Dendritic",df[,paste0(label,"_broad")])] = "Myeloid"
df[,paste0(label,"_broad_2")][grep("HSC|MEMPs",df[,paste0(label,"_broad")])] = "HSC/MPPs"
tmp = aggregate(final_integrated_labels ~ df[,paste0(label,"_broad_2")] + condition + dataset,df,length)
tmp = subset(tmp,tmp[,1] != "Unknown")
colnames(tmp) = c("cell","condition","dataset","count")
tmp = tmp %>%
group_by(dataset) %>%
mutate(total_count = sum(count)) %>%
mutate(proportion = count/total_count) %>% as.data.frame()
return(tmp)
}
boxplot_sample = function(tmp) {
g1 = ggplot(tmp,aes(x=cell,col=condition,y=proportion)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_dodge(width = 0.75)) +
ggpubr::theme_pubr() +
labs(x="Cell type",y='Proportion',col="Condition") +
scale_color_manual(values=c("Ctrl" = "#66BBBB","Ts18" = "#555599","Ts21" = "#DD4444")) +
theme(axis.text.x = element_text(size=rel(0.87)))
return(g1)
}
# plot 2
piechart_preprocess = function(df,label) {
numcell_mat = as.data.frame.matrix(table(df[,c(paste0(label,"_broad_2"),"condition")]));#numcell_mat
propcell_mat = subset(numcell_mat,!(rownames(numcell_mat)%in%c("Unknown")))
for (i in 1:ncol(propcell_mat)) {propcell_mat[,i] = propcell_mat[,i]/sum(propcell_mat[,i])}
propcell_mat$cell = rownames(propcell_mat)
require(reshape2)
propcell_mat.long = reshape2::melt(propcell_mat,id.vars="cell")
return(propcell_mat.long)
}
piechart = function(propcell_mat.long) {
g2 = ggplot(propcell_mat.long,aes(x="",y=value,fill=cell)) +
geom_bar(stat="identity",width=1,color='white')+
coord_polar("y",start=0) +
theme_void() +
facet_wrap(.~variable) +
scale_fill_manual(values=c("B cells" = "#8DD3C7",
"Erythroid" = "#E6E661",
"HSC/MPPs" = "#BEBADA",
"Mast cells" = "#FB8072",
"Megakaryocytes" = "#80B1D3",
"Myeloid" = "#FDB462",
"NK/T cells" = "#B3DE69")) +
theme(strip.text = element_text(face='bold')) +
labs(fill="Cell type")
}
stackedbar_total = function(propcell_mat.long) {
g2b = ggplot(propcell_mat.long,aes(x=variable,y=value*100,fill=cell,col=variable)) +
geom_bar(position="stack", stat="identity") +
scale_color_manual(values=c("Ctrl" = "#66BBBB","Ts18" = "#555599","Ts21" = "#DD4444"),name="Condition") +
scale_fill_manual(values=c("B cells" = "#8DD3C7",
# "Erythroid" = "#FFFFB3",
"Erythroid" = "#E6E661",
"HSC/MPPs" = "#BEBADA",
"Mast cells" = "#FB8072",
"Megakaryocytes" = "#80B1D3",
"Myeloid" = "#FDB462",
"NK/T cells" = "#B3DE69")) +
labs(x="Condition",y="Cell composition (%)",title="Cellular Composition (Multiome)",fill="Cell type") +
ggpubr::theme_pubr() +
theme(panel.grid = element_blank(),
axis.text.x=element_text(hjust=1,angle=60),
plot.title = element_text(hjust=0.5),
legend.position = 'right') +
scale_y_continuous(expand = expansion(mult = 0));
print(g2b)
}
stackedbar_sample = function(tmp) {
g3 = ggplot(tmp,aes(x=dataset,y=proportion*100,fill=cell,col=condition)) +
geom_bar(position="stack", stat="identity") +
scale_color_manual(values=c("Ctrl" = "#66BBBB","Ts18" = "#555599","Ts21" = "#DD4444"),name="Condition") +
scale_fill_manual(values=c("B cells" = "#8DD3C7",
# "Erythroid" = "#FFFFB3",
"Erythroid" = "#E6E661",
"HSC/MPPs" = "#BEBADA",
"Mast cells" = "#FB8072",
"Megakaryocytes" = "#80B1D3",
"Myeloid" = "#FDB462",
"NK/T cells" = "#B3DE69")) +
labs(x="Sample",y="Cell composition (%)",title="Cellular Composition (Multiome)",fill="Cell type") +
ggpubr::theme_pubr() +
theme(panel.grid = element_blank(),
axis.text.x=element_text(hjust=1,angle=60),
plot.title = element_text(hjust=0.5),
legend.position = 'right') +
scale_y_continuous(expand = expansion(mult = 0));
return(g3)
}
annotation_correlation_plot = function(tmp.mg) {
g4=ggplot(tmp.mg,aes(x=proportion.x,y=proportion.y,col=cell,shape=condition)) +
geom_point(size=rel(2)) +
ggpubr::theme_pubr() +
geom_abline(slope=1,intercept = 0,lty='dashed',col='red') +
labs(x="Separate",y="Integrated",col="Cell type",lty='dashed',col='red') +
scale_color_manual(values=c("B cells" = "#8DD3C7",
"Erythroid" = "#E6E661",
"HSC/MPPs" = "#BEBADA",
"Mast cells" = "#FB8072",
"Megakaryocytes" = "#80B1D3",
"Myeloid" = "#FDB462",
"NK/T cells" = "#B3DE69")) +
scale_shape_manual(values=c("Ctrl" = 19,"Ts18" = 15,"Ts21" = 17),name="Condition") +
theme(legend.position = 'right') +
facet_wrap(.~condition) #+
return(g4)
}
head(df)
library(data.table)
f = "~/Documents/Research/Trisomy/output/data/Trisomy18_Trisomy21_Ctrl/annotations.meta_data.v4.txt"
df = fread(f,data.table = F,stringsAsFactors = F)
head(Df)
head(df)
label
label="separate_labels_broad"
df[,paste0(label,"_broad_2")] = df[,paste0(label,"_broad")]
label="separate_labels"
df[,paste0(label,"_broad_2")] = df[,paste0(label,"_broad")]
df[,paste0(label,"_broad_2")][grep("Monocytic|Granulocytic|Dendritic",df[,paste0(label,"_broad")])] = "Myeloid"
df[,paste0(label,"_broad_2")][grep("HSC|MEMPs",df[,paste0(label,"_broad")])] = "HSC/MPPs"
head(df)
dim(df)
df = df[df[,paste0(label,"_broad_2")]!="Unknown",]
dim(Df)
dim(df)
head(df)
